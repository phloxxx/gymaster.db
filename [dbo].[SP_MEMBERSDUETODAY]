USE [GYMASTER]
GO
/****** Object:  StoredProcedure [dbo].[SP_MEMBERSDUETODAY]    Script Date: 09/12/2024 12:47:32 am ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[SP_MEMBERSDUETODAY]
AS
BEGIN
    SET NOCOUNT ON;
    SELECT 
        M.MEMBER_ID,
        M.MEMBER_FNAME,
        M.MEMBER_LNAME,
        M.EMAIL,
        M.PHONE_NUMBER,
        S.SUB_NAME,
        MS.END_DATE
    FROM 
        MEMBER M
    INNER JOIN 
        MEMBER_SUBSCRIPTION MS ON M.MEMBER_ID = MS.MEMBER_ID
    INNER JOIN 
        SUBSCRIPTION S ON MS.SUB_ID = S.SUB_ID
    WHERE 
        MS.END_DATE = CAST(GETDATE() AS DATE)
        AND MS.IS_ACTIVE = 1
    ORDER BY 
        M.MEMBER_LNAME, 
        M.MEMBER_FNAME;
END
